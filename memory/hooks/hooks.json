{
  "PostToolUse": [
    {
      "matcher": "Write|Edit|Bash",
      "hooks": [
        {
          "type": "command",
          "command": "~/.claude/plugins/cache/duk-market/duk-memory/0.1.0/scripts/auto-observe.sh",
          "timeout": 5,
          "async": true
        }
      ]
    }
  ],
  "SessionStart": [
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "~/.claude/plugins/cache/duk-market/duk-memory/0.1.0/scripts/load-context.sh",
          "timeout": 5
        }
      ]
    }
  ],
  "Stop": [
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "~/.claude/plugins/cache/duk-market/duk-memory/0.1.0/scripts/auto-summary.sh",
          "timeout": 10
        },
        {
          "type": "agent",
          "command": "세션이 끝납니다. 아래 기준에 따라 메모리 저장 여부를 판단하세요.\n\n## 판단 기준\n\n1. observations 테이블에서 현재 session_id의 tool_name='Write' 또는 'Edit' 기록이 3개 이상 → 의미 있는 작업 세션\n2. Bash 도구로 git commit이 실행된 기록이 있으면 → 커밋 메시지를 memories에 저장 (category: 'til')\n3. observations에서 에러 수정 패턴 발견 (같은 파일을 3회 이상 수정, 또는 Bash에서 에러 후 Edit) → category: 'bugfix'\n4. 새로운 파일 생성이 3개 이상 → 아키텍처 결정으로 category: 'decision'\n5. 위 기준에 해당하지 않으면 (파일 읽기만, 간단한 질문 등) → 아무것도 저장하지 마세요\n\n## 저장 방법\n\nDB는 Docker 컨테이너(duk-memory) 내 /data/duk-market.db 에 있습니다.\nPROJECT: 현재 디렉토리 basename\nimportance: 자동 저장이므로 3으로 설정\n\ndocker exec duk-memory sqlite3 /data/duk-market.db \"INSERT INTO memories (category, title, content, tags, project, importance, session_id) VALUES (...);\"\n\ntitle은 50자 이내로 핵심만, content는 200자 이내로 요약하세요."
        }
      ]
    }
  ]
}
