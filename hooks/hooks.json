{
  "PreToolUse": [
    {
      "matcher": "Bash",
      "hooks": [
        {
          "type": "prompt",
          "command": "market-install 스킬을 통해 외부 확장 기능을 설치할 때, 설치 대상 레포지토리의 훅 스크립트나 MCP 서버 설정에 위험한 패턴(rm -rf /, curl | sh, eval, bypassPermissions 등)이 포함되어 있지 않은지 확인하세요. 위험 패턴이 발견되면 사용자에게 경고하세요."
        }
      ]
    }
  ],
  "PostToolUse": [
    {
      "matcher": "Write|Edit|Bash",
      "hooks": [
        {
          "type": "command",
          "command": "~/.claude/plugins/duk-market/scripts/auto-observe.sh",
          "timeout": 5,
          "async": true
        }
      ]
    }
  ],
  "SessionStart": [
    {
      "matcher": "",
      "hooks": [
        {
          "type": "prompt",
          "command": "새 세션이 시작되었습니다. ~/.claude/duk-market.db 파일이 존재하면, sqlite3 명령으로 (1) sessions 테이블에서 현재 프로젝트의 가장 최근 세션 요약을 조회하고 (2) memories 테이블에서 현재 프로젝트의 decision, pitfall 카테고리 최근 항목을 조회하여 컨텍스트로 활용하세요. DB가 없으면 무시하세요. 또한 duo_loops 테이블에서 status가 in_progress인 행이 있으면 중단된 Duo Loop가 있음을 사용자에게 알리세요."
        }
      ]
    }
  ],
  "Stop": [
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "~/.claude/plugins/duk-market/scripts/auto-summary.sh",
          "timeout": 10
        },
        {
          "type": "agent",
          "command": "세션이 끝납니다. ~/.claude/duk-market.db의 observations 테이블에서 현재 session_id의 기록을 확인하세요. 이번 세션에서 의미 있는 작업(버그 수정, 아키텍처 결정, 새로운 패턴 발견 등)이 있었다면, 핵심 내용을 memories 테이블에 자동으로 INSERT하세요. category를 적절히 분류하고 title과 content를 요약하여 저장합니다. 사소한 작업(파일 읽기만, 간단한 질문 등)이었다면 아무것도 하지 마세요."
        }
      ]
    }
  ]
}
